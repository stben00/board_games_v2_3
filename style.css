:root{
  --bg:#0b1020; --panel:rgba(255,255,255,.06); --text:rgba(255,255,255,.92);
  --muted:rgba(255,255,255,.65); --border:rgba(255,255,255,.12);
  --shadow:0 18px 50px rgba(0,0,0,.35); --r:18px;
  --light:#e7e1d6; --dark:#2b2a33;
  --accent:#7c5cff; --good:#31d17c; --bad:#ff4d6d; --warn:#ffd166;
}
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Arial;
  background:radial-gradient(1200px 700px at 20% 10%, rgba(124,92,255,.25), transparent 60%),
             radial-gradient(900px 600px at 80% 30%, rgba(49,209,124,.12), transparent 55%),
             var(--bg);
  color:var(--text);
}
.topbar{
  position:sticky;top:0;z-index:10;
  display:flex;justify-content:space-between;align-items:center;
  padding:14px 18px;border-bottom:1px solid var(--border);
  backdrop-filter:blur(14px);background:rgba(11,16,32,.7);
}
.brand{display:flex;gap:12px;align-items:center}
.logo{
  width:42px;height:42px;display:grid;place-items:center;border-radius:14px;
  background:linear-gradient(135deg, rgba(124,92,255,.35), rgba(255,255,255,.08));
  border:1px solid var(--border);box-shadow:var(--shadow);font-size:20px;
}
.title{font-weight:800}
.subtitle{color:var(--muted);font-size:12.5px;margin-top:2px}
.controls{display:flex;gap:12px;align-items:center}
.segmented{display:flex;background:rgba(255,255,255,.06);border:1px solid var(--border);border-radius:999px;padding:4px}
.seg{border:0;color:var(--muted);background:transparent;padding:8px 12px;border-radius:999px;cursor:pointer;font-weight:700}
.seg.active{color:var(--text);background:rgba(124,92,255,.28)}
.btn{border:1px solid var(--border);background:rgba(255,255,255,.06);color:var(--text);
     padding:10px 14px;border-radius:12px;cursor:pointer;font-weight:700}
.btn:hover{background:rgba(255,255,255,.09)}
.layout{max-width:1180px;margin:18px auto;padding:0 16px 24px;display:grid;grid-template-columns:1fr 360px;gap:16px}
.boardCard,.sideCard{background:var(--panel);border:1px solid var(--border);border-radius:var(--r);box-shadow:var(--shadow)}
.boardHeader{display:flex;justify-content:space-between;align-items:center;padding:14px 14px 10px;border-bottom:1px solid var(--border)}
.status{display:flex;gap:10px;align-items:center;font-weight:700;flex-wrap:wrap}
.dot{width:10px;height:10px;border-radius:99px;background:var(--warn);box-shadow:0 0 18px rgba(255,209,102,.45)}
.pill{font-size:12px;padding:4px 10px;border-radius:999px;border:1px solid var(--border);background:rgba(255,255,255,.06);color:var(--muted)}
.hint{color:var(--muted);font-size:13px}
.boardWrap{padding:14px;display:grid;place-items:center;gap:8px}
.rankRow{display:flex;gap:8px;align-items:stretch}
.files,.ranks{display:grid;gap:6px;color:rgba(255,255,255,.55);font-size:12px;user-select:none}
.files{grid-template-columns:repeat(8,1fr);width:min(76vh,640px);padding:0 6px}
.ranks{grid-template-rows:repeat(8,1fr);padding:6px 0}
.files span,.ranks span{display:grid;place-items:center;width:100%}
.board{
  width:min(76vh,640px);aspect-ratio:1/1;display:grid;grid-template-columns:repeat(8,1fr);
  border-radius:16px;overflow:hidden;border:1px solid rgba(255,255,255,.14)
}
.cell{display:grid;place-items:center;user-select:none;cursor:pointer;position:relative}
.cell.light{background:var(--light)}
.cell.dark{background:var(--dark)}
.cell.disabled{cursor:not-allowed;filter:grayscale(.1) brightness(.95)}
.piece{font-size:clamp(22px,4.4vmin,44px);filter:drop-shadow(0 10px 18px rgba(0,0,0,.35))}
.checker{
  width:70%;aspect-ratio:1/1;border-radius:999px;box-shadow:0 14px 30px rgba(0,0,0,.35);
  border:2px solid rgba(255,255,255,.18);display:grid;place-items:center;font-weight:900;font-size:18px
}
.checker.w{background:linear-gradient(180deg,#f6f2ea,#d8d2c6);color:#2b2a33}
.checker.b{background:linear-gradient(180deg,#1a1a22,#09090e);color:#f6f2ea}
.checker.king::after{content:"K";opacity:.9}
.cell.selected::after{content:"";position:absolute;inset:8%;border:2px solid rgba(124,92,255,.9);border-radius:14px}
.cell.hintMove::before{content:"";width:16%;aspect-ratio:1/1;border-radius:99px;background:rgba(124,92,255,.65);position:absolute}
.cell.capture::before{content:"";position:absolute;inset:8%;border:2px solid rgba(255,77,109,.85);border-radius:14px}
.cell.check::after{content:"";position:absolute;inset:10%;border:2px solid rgba(255,209,102,.95);border-radius:14px;box-shadow:0 0 18px rgba(255,209,102,.35)}
.boardFooter{padding:0 14px 14px}
.msg{min-height:20px;color:var(--muted);font-size:13px}
.sideCard{padding:14px}
.divider{height:1px;background:var(--border);margin:12px 0}
.history{max-height:280px;overflow:auto;padding-right:6px;display:flex;flex-direction:column;gap:8px}
.histItem{padding:10px 10px;border-radius:12px;border:1px solid var(--border);background:rgba(255,255,255,.05);
          color:rgba(255,255,255,.78);font-size:13px;line-height:1.4}
.notes{margin:0 0 12px;padding-left:18px;color:var(--muted);line-height:1.6}
.small{color:rgba(255,255,255,.55);font-size:12px}
.modePanel{
  display:flex;flex-direction:column;gap:10px;
  padding: 10px;border-radius: 14px;border: 1px solid var(--border);
  background: rgba(255,255,255,.05);margin-bottom: 10px;
}
.modePanel .row{ display:flex; align-items:center; justify-content:space-between; gap:10px; }
.modePanel .lbl{ color: rgba(255,255,255,.72); font-size: 13px; }
.select{
  width: 170px;padding: 8px 10px;border-radius: 12px;border: 1px solid var(--border);
  background: rgba(255,255,255,.06);color: var(--text);outline: none;
}
.muted{ color: var(--muted); }
@media (max-width:1040px){
  .layout{grid-template-columns:1fr}
  .files{width:min(86vw,640px)}
  .board{width:min(86vw,640px)}
}

.btn.ghost{ background: rgba(255,255,255,.03); }
.btn.ghost:hover{ background: rgba(255,255,255,.07); }

.cell.lastFrom::after{
  content:"";
  position:absolute;
  inset:0;
  background: rgba(255,209,102,.10);
}
.cell.lastTo::after{
  content:"";
  position:absolute;
  inset:0;
  background: rgba(49,209,124,.12);
}

/* Modal */
.modal{
  position:fixed; inset:0;
  display:grid; place-items:center;
  background: rgba(0,0,0,.55);
  z-index: 1000;
  padding: 18px;
}
.modal.hidden{ display:none; }
.modalCard{
  width: min(420px, 92vw);
  background: rgba(18,24,44,.92);
  border: 1px solid rgba(255,255,255,.12);
  border-radius: 18px;
  box-shadow: 0 22px 70px rgba(0,0,0,.55);
  padding: 16px;
}
.modalTitle{ font-weight: 900; font-size: 18px; margin-bottom: 6px; }
.modalSub{ color: rgba(255,255,255,.70); font-size: 13px; margin-bottom: 12px; }
.promoGrid{ display:grid; grid-template-columns:1fr 1fr; gap:10px; }
.promoBtn{
  cursor:pointer;
  padding: 12px 12px;
  border-radius: 14px;
  border: 1px solid rgba(255,255,255,.14);
  background: rgba(255,255,255,.06);
  color: rgba(255,255,255,.92);
  font-weight: 800;
}
.promoBtn:hover{ background: rgba(255,255,255,.10); }
.modalActions{ display:flex; justify-content:flex-end; margin-top: 12px; }
